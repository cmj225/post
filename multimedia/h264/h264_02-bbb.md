---
description: 영상 압축기술의 발전과 H.264/AVC의 기반이 되는 기초지식
---

# 영상 압축기술의 발전과 기초지식

## 영상 압축 기술의 역사적 발전

* 영상 압축부호화의 **`목적`**
  * 원영상의 중요한 정보는 보존
  * 기타 정보\(중복된 정보\)를 다소 제거하여 데이터 양을 줄임
  * **`원화질을 잃지 않으면서 가능한 한 적은 데이터로 영상을 표현`**
* 영상 압축부호화 기술의 발전
  * `화소기반` : 화소 그 자체를 처리의 단위로 부호화하는 기술, `[예측]`
  * `블록기반` : 화소의 블록을 처리단위로 부호화하는 기술, `[변환]`
  * 현대 동영상 압축에서는 위 두가지를 혼합한 `하이브리드(혼성) 부호화`가 중심축이 된다.

![](../../.gitbook/assets/image%20%2819%29.png)

* 용어 해설
  * **`화소 부호화(Pel-based coding)`** 화소를 하나의 처리단위로 하는 부호화
  * **`PCM(Pulse Code Modulation)`**  화소의 값을 디지털로 표현한 부호화
  * **`DPCM(Differential PCM)`** 이웃한 화소간의 차분치를 보내는 부호화
  * **`단순 프레임간 예측 부호화(Simple interframe prediction)`** : 이전 화면으로부터 현재의 화면을 예측하는 부호화
  * **`블록 부호화(Block-based coding)`** : 복수 개의 화소\(예를 들어 8x8=64개\)로 이뤄진 블록을 하나의 처리단위로 하는 부호화
  * **`움직임보상 프레임간 예측부호화(MC, Motion Compensated interframe prediction)`** 피사체의 움직임 정보를 사용해서, 이전화면으로부터 현재의 화면을 예측하는 부호화
  * **`변환부호화(Transform coding, DCT(Discrte Cosine Transform)`**  복수화소로 이뤄진 블록을 주파수 영역으로 변환한 후 처리하는 부호화
  * **`백터양자화(Vector Quantization)`** 복수화소로 이뤄진 블록을 미리 선택한 대표 패턴의 하나로 대응시키는 부호화
  * **`하이브리드 부호화(Hybrid Coding)`** 화소부호화인 움직임보상 프레임간 예측부호화\(MC\)와 블록부호화인 변환 부호화\(DCT\) 또는 벡터양자화\(VQ\) 등을 조합한 부호화
* 차례대로 각각을 자세히 살펴봄
  * ITU-R에서 정한 영상 압축부호화 시험영상인   [**`sie`**](https://www.youtube.com/watch?v=7_54nJ8z0kY) 를 사용하여 내용 소개

## PCM

* **`PCM(Pulse Code Modulation, 펄스부호변조)`** : 아날로그 신호를 **`샘플링`** + **`양자화`**하여 디지털 신호로 표현한 것

  * 디지털 신호화의 기본
  * **`샘플링(Sampling)`** : 시간방향과 진폭방향으로 연속적인 아날로그 신호를 일정간격으로 추출
  * **`양자화(Quantization)`** : 진폭방향으로 어떤 범위의 값을 하나의 대표값으로 표현
  * ![](../../.gitbook/assets/image%20%2817%29.png) 



  * 컬러TV 신호의 표준 : `Y Cb Cr`

    * Y : 화면의 \[밝기\]를 표현하는 휘도신호
    * Cb, Cr: 화면의 \[색\]을 표현하는 색차신호
    * 인간의 눈은 \[밝기\]에 비해 \[색\]에 대한 해상도가 높지 않은 점에 착안해, 색차정보를 화소간 공유시킴으로서 데이터 양을 줄일 수 있음.
    * 다양한 YUV pixel format 참조

## DPCM

**예측 오차만을 보내는 DPCM**

* **`DPCM(Differential PCM, 차분 PCM)`**

  * 예측한 신호와 입력된 신호의 오차인 **`예측오차(Differential)`**만을 보내는 방법
  * `가장 단순한 예측`방법은 `현재의 화소값과 직전 화소값이 같다고 가정`하는 것

    | PCM | 5 | 6 | 5 | 5 | 4 | 5 | ... |
    | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
    | DPCM | +5 | +1 | -1 | 0 | -1 | +1 | ... |

  * **`차분치의 진폭분포는 0주변에 집중된 지수분포`**로 그 값들이 0 주위로 집중기 때문에, 이를 이용해 차분으로 신호를 표현함으로 **`보다 적은 정보량으로 신호를 표현`** 가능
  * 아래의 이미지의 Y신호에서 차분을 표현한 경우, 대부분의 신호가 0이되고\(흰색\), 차분에 대한 부분이 남

          ![](../../.gitbook/assets/image%20%2815%29.png)  ![](../../.gitbook/assets/image%20%2812%29.png) 



  * 예측부호화의 **`부호기와 복호기`**의 구성
    * 예측이란 현재 주어진 정보를 바탕으로 미래의 정보를 추측하는 것으로, 이를 이용하기 위해서는 부호기와 복호기의 구성이 다음과 같이 이뤄짐.
    * 부호기와 복호기에서는 동일한 국부복호기를 사용하여, 동일한 예측오차를 받았을 때, 동일한 이미지로 복원이 가능하다.
  * **`예측의 정확도가 높을 수록, 차분이 0에 수렴하게 되므로 더 데이터를 줄일 수 있다`**
    * 예측의 정확도를 높이기 위해서는 과거의 데이터를 활용할 수 있다.
    * 이러한 예측에 사용되는 화소의 위치에 따라 다음과 같이 구분할 수 있다.
      * **`[프레임내(화면내) 예측]`** 
      * **`[프레임간(화면간) 예측]`**
    * **`프레임내(화면내 예측)`**
      * 일반적으로 이미 부호화된 주변의 화소\(좌측, 상단\)를 가중평균하여 현재 부호화하려는  화소를 예측하는 방식을  사용 `(좌측 화소값 * 0.5 + 상단 화소값 * 0.5)`

![](../../.gitbook/assets/image%20%2816%29.png)

![](../../.gitbook/assets/image%20%2814%29.png)

## 프레임간\(화면간\) 예측부호

* 예측하려는 화소가 다른 프레임에 존재
* **`정적인 영상의 경우`** 화면간 차이가 작아 비교적 정확하고, 수월하게 예측할 수 있기 때문에 DPCM을 이용하는 경우 큰 압축효과를 얻을 수 있다
* 다만, 이를 위해서는 **`이전 프레임에 대한 영상신호를 저장하고 있어야 하는 문제`**가 있어, 1970년대 이후 충분한 메모리가 확보된 뒤부터 부호하 장치가 실현되었다

## MC\(움직임보상 프레임간 예측부호화\)

#### Motion Compensate interframe prediction

* 큰 움직임이 발생하는 **`동적인 영상의 경우`**  프레임간 유사성이 약하기 때문에, 차분을 이용할 경우에 오히려 정보량이 증가하는 역효과가 발생할 수 있다.
*  이러한 경우 피사체의 **`움직임에 관한 정보(움직임 벡터, motion vector)`**를 안다면, 이것을 이용해 예측화면\(A'\)을 만들 수 있고, 이를 이용하면 많은 데이터를 절약할 수 있다.
* 위와 같은 방식의 압축을 위해서는 motion vector를 구해야 하는데, 이러한 작업에 많은 연상량을 필요로 하여 1980년대에 들어서야 실용화되기 시작했다.
* 나중에 자세히 살펴보겠지만, Motion Vector를 찾는 방법은 대략 다음과 같다.
  * 하나의 화면은 작은 블록으로 구분하고, 각 블록마다 Motion Vector를 정의
  * 부호화하려는 블록과 가장 유사한 블록을 예측영상에서 탐색하여 찾는다
  * 블록을 작게 할수록 정확한 예측이 가능하지만, 필요한 연산량이 증가하므로 적정크기의 블록을 선택해야 한다
  * 복호기 쪽에서는 예측영상에 받은 Motion Vector와 예측오차 정보를 이용해 프레임을 복원해낸다

![](../../.gitbook/assets/image%20%2823%29.png)

* MC의 확장
  * MPEG-1 표준에서는 과거 프레임 뿐만 아니라 미래의 프레임까지 이용하여 움직임보상을 수행하는 방법을 채택, \[양방향 움직임보상 프레임간 예측\]
  * 압축효과가 큰 기술이지만, 압축을 위해 미래의 화면도 필요하므로 부호화 순서가 바뀌어야 하므로 지연이 발생하게 된다.
  * 1990년대에 들어서야 실용화되었다.

![](../../.gitbook/assets/image%20%2825%29.png)

## DCT\( Discrete Cosine Transform, 이산여현변환\)

* 1980년대에 이르러서야 실용화된 압축부호화 기술
* 화소단위의 부호화와 달리, 16x16, 8x8 등 복수의 화소를 모아서 블록을 만들고 그 블록 단위로 압축부호화 처리를 수행하는 **`블록부호화 기술`**
* 화소를 블록화함으로써 **`집합적인 정보중복도를 제거`**할 수 있어 압축의 효율을 높일 수 있다
* **`DCT`** 는 화소영역 표현인 $$[f(i,j)]$$ 를 주파수 영역 표현인 $$[F(u, v)]$$ 로 변경하여 원래의 영상을 2차원 주파수 성분으로 변환하는 처리이며, 주파수 성분들은 기저영상\(기본패턴\)으로 표현된다
* 이러한 DCT는 단순히 표현만 바꾸는 변환으로 정보의 손실이 없으며, **`원래의 신호로 복원될 수 있다`**
* **`DCT의 특징`**은 **`DCT 변환 후의 DCT계수치가 0근처의 값들에 몰려 분포`**한다는 것으로, 이를 이용해 높은 압축효과를 얻을 수 있다

## 벡터양자화\(Vector Quantization\)

#### 복수화소를 양자화한

* 1980년대 후반에 고안됨
* 복수개의 화소값으로 부터 다양한 영상패턴을 얻을 수 있다.
* 이 때, 이러한 영상 패턴은 영상에 따라 빈번하게 출현하는 패턴과 그렇지 않은 패턴으로 나뉜다.
* 영상패턴의 모임을  미리 정해두고, 각각의 영상패턴을 이에 대응시켜 해당 패턴에 대응하는 값으로 전송한다. \(PCM의 Quantization 참고\)

![](../../.gitbook/assets/image%20%2820%29.png)

## 하이브리드 부호화

* \[예측\]과 \[변환\]이란 두 가지 특성을 모두 사용한 영상 압축부호화 방식으로, 압축부호화의 표준적인 구조가 됨
* 일반적으로 다음과 같은 과정으로 이루어진다
  * 포맷변환 : 영상을 의도한 화소수의 포맷으로 변환
  * 프레임 순서 변경 : 양방향 예측등을 대비하여 부호화 순서에 맞게 배열
  * 잡음제거 등 : 임의 잡음 제거
  * 움직임 보상 프레임간 예측 : 예측화면을 만든다
  * DCT : 예측화면을 주파수영역의 데이터로 변환한다
  * 양자화 : DCT 계수값을 양자화한다
    * 왜곡을 허용하는 비가역처리를 통해 큰 압축효율을 얻을 수 있다.
  * 가변길이부호화 : 빈도가 높은 정보를 짧은 부호로, 그렇지 않은 정보는 긴 부호로 표현하여 전체적인 전송 비트수를 줄인다 \(엔트로피코딩\)



